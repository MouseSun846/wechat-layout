/*! For license information please see background.js.LICENSE.txt */
(()=>{function e(){var t,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(e,o,i,a){var c=o&&o.prototype instanceof s?o:s,f=Object.create(c.prototype);return n(f,"_invoke",function(e,n,o){var i,a,c,s=0,f=o||[],l=!1,d={p:0,n:0,v:t,a:p,f:p.bind(t,4),d:function(e,n){return i=e,a=0,c=t,d.n=n,u}};function p(e,n){for(a=e,c=n,r=0;!l&&s&&!o&&r<f.length;r++){var o,i=f[r],p=d.p,h=i[2];e>3?(o=h===n)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=p&&((o=e<2&&p<i[1])?(a=0,d.v=n,d.n=i[1]):p<h&&(o=e<3||i[0]>n||n>h)&&(i[4]=e,i[5]=n,d.n=h,a=0))}if(o||e>1)return u;throw l=!0,n}return function(o,f,h){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&p(f,h),a=f,c=h;(r=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(d.n=-1),p(a,c)):d.n=c:d.v=c);try{if(s=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((r=(l=d.n<0)?c:e.call(n,d))!==u)break}catch(e){i=t,a=1,c=e}finally{s=1}}return{value:r,done:l}}}(e,i,a),!0),f}var u={};function s(){}function f(){}function l(){}r=Object.getPrototypeOf;var d=[][i]?r(r([][i]())):(n(r={},i,function(){return this}),r),p=l.prototype=s.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,n(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return f.prototype=l,n(p,"constructor",l),n(l,"constructor",f),f.displayName="GeneratorFunction",n(l,a,"GeneratorFunction"),n(p),n(p,a,"Generator"),n(p,i,function(){return this}),n(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:h}})()}function n(e,t,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}n=function(e,t,r,o){function a(t,r){n(e,t,function(e){return this._invoke(t,r,e)})}t?i?i(e,t,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[t]=r:(a("next",0),a("throw",1),a("return",2))},n(e,t,r,o)}function t(e,n,t,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void t(e)}c.done?n(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var n=this,r=arguments;return new Promise(function(o,i){var a=e.apply(n,r);function c(e){t(a,o,i,c,u,"next",e)}function u(e){t(a,o,i,c,u,"throw",e)}c(void 0)})}}var o="https://mp.weixin.qq.com/";chrome.runtime.onInstalled.addListener(function(){chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0})}),chrome.action.onClicked.addListener(function(){var n=r(e().m(function n(t){return e().w(function(e){for(;;)switch(e.p=e.n){case 0:if(!t.url||!t.url.includes(o)){e.n=8;break}return e.p=1,e.n=2,chrome.sidePanel.getOptions({tabId:t.id});case 2:if(!e.v.enabled){e.n=4;break}return e.n=3,chrome.sidePanel.setOptions({tabId:t.id,enabled:!1});case 3:e.n=5;break;case 4:return e.n=5,chrome.sidePanel.setOptions({tabId:t.id,path:"sidepanel.html",enabled:!0});case 5:e.n=7;break;case 6:return e.p=6,e.v,e.n=7,chrome.sidePanel.setOptions({tabId:t.id,path:"sidepanel.html",enabled:!0});case 7:chrome.tabs.sendMessage(t.id,{action:"injectUI"},function(e){chrome.runtime.lastError&&chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]},function(){chrome.tabs.sendMessage(t.id,{action:"injectUI"})})});case 8:return e.a(2)}},n,null,[[1,6]])}));return function(e){return n.apply(this,arguments)}}()),chrome.tabs.onUpdated.addListener(function(){var n=r(e().m(function n(t,r,i){return e().w(function(e){for(;;)switch(e.n){case 0:if(i.url){e.n=1;break}return e.a(2);case 1:if(new URL(i.url).origin!==o){e.n=3;break}return e.n=2,chrome.sidePanel.setOptions({tabId:t,path:"sidepanel.html",enabled:!0});case 2:e.n=4;break;case 3:return e.n=4,chrome.sidePanel.setOptions({tabId:t,enabled:!1});case 4:return e.a(2)}},n)}));return function(e,t,r){return n.apply(this,arguments)}}()),chrome.runtime.onMessage.addListener(function(e,n,t){"requestMarkdownInput"===e.action&&chrome.action.openPopup()})})();